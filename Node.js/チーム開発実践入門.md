# チーム開発実践入門

# チーム開発で必要なこと
1. 「何を」「いつまでに」「誰が」実行するのか、「何が」できたら「完了」なのかを管理・共有する
2. ソースコードをはじめとする成果物をチームで共有
3. 成果物の変更を管理し、成果物が壊れない様に保ちつつ、各メンバーが並行作業できるようにすること
4. プロジェクトで得られた知識をチーム間で共有すること
5. チーム開発したソフトウェアがいつでも正しく動作することを証明すること
6. 誰がやっても間違いなく開発・テスト・リリースができるように作業を自動化すること

## リファクタリングとは
- 「プログラミング外部からの見た動作を買えずにソースコードの内部構造を整理すること」
- 外部から見た動作が変わっていないことを保証する必要がある
  - そのプログラムにおいての「正しさ」を仕様書やドキュメントで定義する必要がある
  - 手動で行っていたテストをテストコードを書くことで自動で確認できるようにするのが良い

# 理想的なプロジェクト
- チケット管理システムに課題などが集約されている
  - 発生した障害などをメールではなく、チケットシステムなどを利用して１ヶ所に統合管理すべき
  - また、一つ一つのチケットのステータスがわかるようになっていることが重要
  - 検索も用意で、過去に起きたチケットや関連チケットも探せることが重要
- できる限りバージョン管理システムを利用する
  - バージョン管理システムを使い、他人の修正に気付き上書きをしないようにする
  - dev,stage,prodなど、ブランチがどの環境の物なのかをわかりやすいことが重要
  - データベースの変更管理や環境によって変わる設定ファイルん管理などでも活用すると良い
- 繰り返し再検証可能なCIシステムを用意する
  - コミット漏れや修正ミスに気付くため、ビルドしてチェックし、単体テストに常にパスすすかをチェックする
  - 適切（何回でも繰り返し実行可能で、依存して結果が変わることがない）なテストやビルドを書く必要がある
- 環境の影響を最小限にとどめ、常にリリース可能にしておく
  - 繰り返し実行可能な形で環境構築からリリース、動作確認のテストを用意しておけば、いつでも最新アプリをリリースできる
- すべてを記録して追跡可能にする
  - 今まであげたすべてを管理、記録、追跡に可能にすることが可能です
  - いつ・誰が・どのようにアプリを変更したのか
  - どのような課題がもとになって発生したのか
  - テストをパスしたのか
  - リリースはどうかなど
  - これらはExcelの台帳を使って複数人が管理するのではなく、すべて自動的bに勝つ簡潔に管理されるべきです

# バージョン管理システムを使うと便利なこと
- 変更内容という最も基本的な記録が残る
- バージョン間の差分を簡単に確認できる
- 間違って他人の変更を上書きしないで済む仕組みがある
- 任意の時点まで巻き戻すことだできる
- 複数の派生を作ることだできる、ある時点での断面を保存できる

# 分散バージョン管理システムを使うべき５つのメリット
- リポジトリの完全なコピーをローカルに持つことができる
- 動作が速い
- 一時的な作業の履歴管理医が容易である
- ブランチ、マージが手軽にできる
- 場所を選ばないコラボレーションが可能

# 分散バージョン管理システムのデメリット
- 真の意味では最新バージョンはシステム上に存在しない
- 真の意味ではリビジョン番号はない
- ワークフローが柔軟にせってできすぎるため混乱しやすい
- 考え方に慣れるのに時間がかかる

# 管理すべきもの
- ソースコード
- 用件書。設計書などのドキュメント
- データベーススキーマ、データ
- ミドルウェアなどの設定ファイル
- ライブラリなどの依存関係の定義

# タグの使い方
- スナップショットをタグとして管理しておく
  - 例えば、リリースのタイミングでタグを打つなど

# github-flow
- masterのものはすべてリリース可能である
- 新しく何かをするときはmasterから直接ブランチを作る
- 作成したブランチはローカルマシンにコミットして、リモートリポジトリにも同じ名前のブランチとして定期的にpushする
- 開発が完了したらmasterへpull requestを送る
- PullRequestがレビューされたらmasterにマージし、本番環境にリリースする
## 開発者の認識
- masterはリリース用だから直接触らない
- 作業を始める際にブランチを切ってから始める
- 作業が終了したらmasterにPullRequestする

# うまくいかないプロジェクト
- プロジェクトの見えるかができていない
- タスクの整理、進歩の管理、情報の共有などができていない

# チケット管理システムの導入メリット
- タスク管理をするための基本機能がある
  - タスクの定義：何をしなければいけないのか
  - 担当のアサイン：誰がするのか
  - 期限の管理：いつまでにするのか
  - ステータスの管理：今どうなっているのか、作業中なのか、完了したのか
- 一卵性、検索生が高い
- 情報の一元管理と共有が可能である
- レポーティングに利用できる
- ほかのシステムとの連携が可能、拡張性がある

# チケット駆動開発(=TiDD)
- 基本ルール
  - チケットのないコミットは禁止
- チケット駆動開発の具体的な手順
  1. 新規開発やバグ修正を行う際、その都度内容やもおく的を記述したチケットを気表することから始まる
  2. チケットの内容に応じてコードを修正してコミット
  3. コミットログにチケット番号を入れることが重要
  4. チケットにもコミットログの番号を記入して相互に関連づける

# チケット管理システムとバージョン管理システムの連携
- 連携によって実現する機能
  - コミットからチケットへのリンク
  - チケットかrあコミットへのリンク
  - コミットと同時にチケットのステータスを変更する

# 新機能の開発、バグの修正時のワークフロー
1. チケットの起票
2. 担当者のアサイン
3. 開発
4. コミット
5. リポジトリにプッシュ

# チケット管理とバグ管理、要求管理
- アジャイル開発方法論「Scrum」の用語より
  - エピック
    - 大きな要望、部署横断の課題など
    - 内容例
      - 新しい市場を開拓するためのシステムを構築する
      - 顧客ごとのダッシュボードを用意し、利用製品の統計情報やユーザーのアクセス状況などが分析できる機能を提供する
    - 非エンジニアが関わることが多い
    - 優先順位付けをするのがメインの目的であるため一覧性が重要
    - あいまいな状態でも始まるものが多く、定型フォーマットは向かず、柔軟な編集が可能なものが多い
    - 複数の人たちの編集、共有の簡単なものが良い
  - ストーリー
    - 具体的な要望、機能要求や仕様に近いレベル
    - 内容例
      - おもてなし感が感じられるよう、ログイン時にユーザーに応じてインセンティブやメッセージなどを出したい
      - ユーザーアクセス状況をユーザーID毎時間毎属性ごとに集計し、ダッシュボードから閲覧、ダウンロード可能にしたい
    - その製品に責任を持つ人（プロダクトオーナー）が書くことが多い
    - 組織やプロジェクトによって変わるが、非エンジンイアもありえるし、プログラマ自身が書くこともある
    - ステータス管理が必要である
    - コードとの関連付けをつけ始めた方が良い
    - 担当者が複数であることも単独であることもある
  - タスク
    - 内容例
      - システムのセットアップをする
      - ユニットテストを書く
    - 具体的な作業内容
    - ストーリーの下に複数ぶら下がるイメージ
    - 担当者は単独
    - コードとの連携が必要かどうかは内容による
  - バグ
    - 障害対応、問い合わせ
    - レベル感はタスクと近い
    - 担当者は通常単独
    - コードとの連携が必要

# 継続的インテグレーション
- インテグレーションを継続的に行うのがCI
- インテグレーション
  - すべてのソースコードを一カ所に集める
  - 依存するライブラリなどにパスを通す
  - 必要な場合はコンパイルする
  - データベースの構築とデータのロードを行う
  - 必要に応じてミドルウェアの設定や起動をお今会う
  - 単体テストと結合テスト、ユーザを受入テストなどを実施する
- 開発手法
  - ウォーターフォール開発
    - 30日〜半年
  - アジャイル開発
    - 2種間程度を繰り返し
- CIに必要なもの
  - バージョン 管理システム
  - ビルドツール
    - make, SCons, Ant, Maven, Gradle, Rake
  - テストコード
    - BDD(振る舞い駆動開発)
      - javascript: Jasmine
  - CIツール
    - Jekins, TravisCI
    - CIの対象となるテストの種類
      - 単体テスト
      - 結合テスト
      - ユーザー受け入れテスト
      - リグレッションテスト
- テストコードの作成は時間がかかるが、手戻りがない分結果的に開発スピードは早くなる

# CIのまとめ
- 常にビルド、常にテストを行える
  - アプリの品質を高く保ちながら、開発スピードを高める

# デプロイ
- デプロイに関わる作業は全て自動化すべきである
- デプロイ自動化における恩恵
  - 細かくたくさんデプロイできればリスクをコントロールしやすくなる
  - いち早く新機能を試してもらえるためフィードバックを早く得られるようになる
  - 組織がスケールする

# デプロイ自動化
- 全てのバージョンを管理せよ
- 全ての環境を同じ方法で構築せよ
- リリース作業は自動化し、事前に検証せよ
- 繰り返しテストせよ
- デプロイメントパイプライン
  - P213
